<form [formGroup]="form">
  <div class="form-group mb-sm">
    <h4>Table</h4>

    <!-- Title -->
    <div class="input-group mb-sm hover-toolbar">
      <span class="input-group-addon" id="sizing-addon2">Title</span>
      <ckeditor
        [config]="{
              toolbar: 'IATMATH',
              readOnly: isReadOnly,
              height: 50
            }"
        formControlName="title"
        debounce="500"
        (focus)="editorOnFocus($event)"
        (blur)="editorOnBlur($event)">
      </ckeditor>
    </div>

    <!-- Table -->
    <div class="table-wrapper">
      <table class="table table-condensed table-hover table-light">
        <thead>
        <!-- Header -->
        <tr formArrayName="columns">
          <th *ngFor="let control of formColumns.controls; let i=index" [formGroupName]="i">
            <div class="input-group input-group-sm hover-toolbar">
              <ckeditor
                [config]="{
                  toolbar: 'IATMATH',
                  readOnly: isReadOnly,
                  height: 50
                }"
                formControlName="label"
                debounce="500"
                (focus)="editorOnFocus($event)"
                (blur)="editorOnBlur($event)">
              </ckeditor>
            </div>
          </th>
          <th class="center">
            <a *ngIf="!isReadOnly" (click)="addColumn()" class="btn btn-default btn-xs">
              <i class="fa fa-plus"></i> <i class="fa fa-columns" aria-hidden="true"></i>
            </a>
          </th>
        </tr>
        </thead>

        <!-- Body -->
        <tbody formArrayName="rows">
        <tr *ngFor="let rowControl of formRows.controls; let i=index" [formGroupName]="i">
          <td *ngFor="let cellControl of formRowCells(i).controls; let j=index" [formGroupName]="j">
            <div class="input-group input-group-sm hover-toolbar">
              <div class="ti-table-cell-align pull-buttons" data-toggle="buttons">
                <label class="btn btn-default btn-xs"
                       [ngClass]="cellControl.value.type === 'label' ? 'active' : ''"
                       (click)="isReadOnly ? false : changeCellType(i, j, 'label')"
                       [class.disabled]="isReadOnly">
                  <input *ngIf="!isReadOnly"
                         type="radio"
                         autocomplete="off"
                         alt="Set as a label">
                  <i class="fa fa-tag" aria-hidden="true"></i>
                </label>
                <label class="btn btn-default btn-xs"
                       [ngClass]="cellControl.value.type === 'answer' ? 'active' : ''"
                       (click)="isReadOnly ? false : changeCellType(i, j, 'answer')"
                       [class.disabled]="isReadOnly">
                  <input *ngIf="!isReadOnly"
                         type="radio"
                         autocomplete="off"
                         alt="Set as an answer">
                  <i class="fa fa-lightbulb-o" aria-hidden="true"></i>
                </label>
              </div>
              <ckeditor
                [config]="{
                  toolbar: 'IATMATH',
                  readOnly: isReadOnly,
                  height: 50
                }"
                formControlName="value"
                debounce="500"
                (focus)="editorOnFocus($event)"
                (blur)="editorOnBlur($event)">
              </ckeditor>
            </div>
          </td>
          <td class="center width-sm">
            <a *ngIf="!isReadOnly" (click)="removeRow(i)" class="gray-dark">
              <i class="fa fa-minus-circle"></i>
            </a>
          </td>
        </tr>

        <!-- Footer -->
        <tr>
          <td *ngFor="let control of formColumns.controls; let i=index" class="center">
            <a *ngIf="!isReadOnly" (click)="removeColumn(i)" class="gray-dark">
              <i class="fa fa-minus-circle"></i>
            </a>
          </td>
          <td>&nbsp;</td>
        </tr>
        </tbody>
      </table>

      <!-- Add row -->
      <a *ngIf="!isReadOnly" (click)="addRow()" class="btn btn-default btn-xs">
        <i class="fa fa-plus"></i> <i class="fa fa-columns rotate90" aria-hidden="true"></i>
      </a>
    </div>
  </div>
</form>
